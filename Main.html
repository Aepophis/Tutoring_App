<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <title>Tutoring Tracker v4</title>
  <style>
    /* Reset & Base */
    * {
      box-sizing: border-box;
    }
    body {
      font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
      background: #eef2f7;
      margin: 0;
      color: #333;
      min-height: 100vh;
    }

    nav {
      background: #3498db;
      display: flex;
      justify-content: space-around;
      padding: 10px 0;
    }
    nav button {
      background: none;
      border: none;
      color: white;
      font-weight: bold;
      cursor: pointer;
      padding: 10px 20px;
      font-size: 16px;
    }
    nav button.active {
      border-bottom: 3px solid #f1c40f;
    }

    .tab-content {
      display: none;
      padding: 20px;
      flex-wrap: wrap;
      gap: 20px;
    }
    .tab-content.active {
      display: flex;
    }

    .panel {
      background: white;
      border-radius: 12px;
      box-shadow: 0 4px 15px rgba(0,0,0,0.1);
      padding: 20px;
      flex-grow: 1;
      flex-basis: 320px;
      display: flex;
      flex-direction: column;
      max-width: 400px;
      min-width: 320px;
    }
  </style>
</head>
<body>
  <nav>
    <button class="nav-tab active" data-tab="students">Students</button>
    <button class="nav-tab" data-tab="calendar">Session Calendar</button>
    <button class="nav-tab" data-tab="notes">Notes & Resources</button>
    <button class="nav-tab" data-tab="logbook">Logbook</button>
  </nav>

  <div id="students" class="tab-content active">
    <!-- STUDENTS PANEL -->
  <div id="studentPanel" class="panel" aria-label="Students Panel">
    <h2>Students</h2>
    <div id="studentList" aria-live="polite" aria-label="Student list"></div>

    <form id="studentForm" aria-label="Student detail form" onsubmit="return false;">
      <label for="inputName">Name</label>
      <input id="inputName" type="text" autocomplete="off" placeholder="Student name" required />

      <label for="inputParents">Parents' Names</label>
      <input id="inputParents" type="text" autocomplete="off" placeholder="Parents' full names" />

      <label for="inputAddress">Home Address</label>
      <input id="inputAddress" type="text" autocomplete="off" placeholder="Home address" />

      <label for="inputContact">Email / Phone Number</label>
      <input id="inputContact" type="text" autocomplete="off" placeholder="Email or phone" />

      <label for="inputGrade">Grade / Year</label>
      <input id="inputGrade" type="text" autocomplete="off" placeholder="Grade or Year level" />

      <label for="inputProficiency">Proficiency</label>
      <input id="inputProficiency" type="text" autocomplete="off" placeholder="Proficiency level (e.g. Beginner)" />

      <label for="inputPayment">Payment per Lesson</label>
      <input id="inputPayment" type="text" autocomplete="off" placeholder="Payment amount" />

      <label for="inputSubject">Subject(s) Learning</label>
      <input id="inputSubject" type="text" autocomplete="off" placeholder="Subject(s)" />

      <button id="saveStudentBtn" type="submit">Save Student</button>
      <button id="newStudentBtn" type="button" style="background:#7f8c8d; margin-top: 5px;">Add New Student</button>
      <button id="deleteStudentBtn" type="button" style="background:#e74c3c; margin-top: 5px; display:none;">Delete Student</button>
    </form>
  </div>
  </div>

  <div id="calendar" class="tab-content">
    <!-- CALENDAR PANEL -->
  <div id="calendarPanel" class="panel" role="region" aria-label="Session Calendar">
    <h2>Session Calendar</h2>
    <div id="calendarHeader">
      <button id="prevMonthBtn" aria-label="Previous Month">&lt;</button>
      <div id="monthYear" aria-live="polite"></div>
      <button id="nextMonthBtn" aria-label="Next Month">&gt;</button>
    </div>
    <div class="calendar-grid" id="calendarGrid" role="grid" aria-label="Calendar days">
      <!-- Days injected here -->
    </div>
    <div id="selectedDate" aria-live="polite">Select a date</div>
    <textarea id="calendarNote" placeholder="Notes for selected date..."></textarea>
    <button id="saveCalendarNoteBtn">Save Note</button>
  </div>
  </div>

  <div id="notes" class="tab-content">
    <!-- NOTES PANEL -->
  <div id="notePanel" class="panel" role="region" aria-label="Notes and Resources">
    <h2>Notes & Resources</h2>
    <div class="tabs" role="tablist">
      <div class="tab active" role="tab" aria-selected="true" tabindex="0" data-tab="notes">Notes</div>
      <div class="tab" role="tab" aria-selected="false" tabindex="-1" data-tab="resources">Resources</div>
      <div class="tab" role="tab" aria-selected="false" tabindex="-1" data-tab="syllabuses">Syllabuses</div>
    </div>

    <textarea id="tabNotes" placeholder="Paste lesson notes here..."></textarea>

    <div id="resourcesEditorContainer">
      <div id="resourcesEditor" contenteditable="true" aria-label="Resources editor"></div>
      <button id="toggleResourcesViewBtn" style="margin-top:8px; width: 150px;">View Links</button>
      <div id="resourcesLinks" style="margin-top: 10px; max-height: 150px; overflow-y: auto;" aria-live="polite"></div>
    </div>

    <textarea id="tabSyllabuses" style="display:none;" placeholder="Paste syllabuses here..."></textarea>
    <button id="saveNotesBtn">Save</button>
  </div>
  </div>

  <div id="logbook" class="tab-content">
    <!-- LOGBOOK PANEL -->
<div id="logbookPanel" class="panel" role="region" aria-label="Logbook Panel">
  <h2>Logbook</h2>
  <form id="logEntryForm" onsubmit="return false;">
    <label for="logType">Type of Entry</label>
    <select id="logType" required>
      <option value="">Select Type...</option>
      <option>New Student</option>
      <option>Student Left</option>
      <option>Incident</option>
      <option>General Note</option>
      <option>Schedule Change</option>
      <option>Parent Communication</option>
      <option>Session Summary</option>
    </select>

    <label for="logStudent">Student</label>
    <select id="logStudent">
      <option value="">Select Student (optional)...</option>
    </select>

    <label for="logDate">Date</label>
    <input id="logDate" type="date" required />

    <label for="logDetails">Details</label>
    <textarea id="logDetails" placeholder="Describe what happened or session summary..." required></textarea>

    <button type="submit">Add Log Entry</button>
  </form>

  <div id="logEntries" style="margin-top: 20px; max-height: 300px; overflow-y: auto;">
    <h3>Previous Entries</h3>
    <ul id="logList" style="padding-left: 20px;"></ul>
  </div>
</div>

<script>
  const logType = document.getElementById('logType');
  const logStudent = document.getElementById('logStudent');
  const logDate = document.getElementById('logDate');
  const logDetails = document.getElementById('logDetails');
  const logList = document.getElementById('logList');

  let logEntries = JSON.parse(localStorage.getItem('logEntries') || '[]');

  function populateStudentDropdown() {
    const studentData = JSON.parse(localStorage.getItem('students') || '[]');
    logStudent.innerHTML = '<option value="">Select Student (optional)...</option>';
    studentData.forEach(s => {
      const option = document.createElement('option');
      option.value = s.name;
      option.textContent = s.name;
      logStudent.appendChild(option);
    });
  }

  function renderLogEntries() {
    logList.innerHTML = '';
    if (logEntries.length === 0) {
      logList.innerHTML = '<em>No log entries yet.</em>';
      return;
    }

    logEntries.forEach(entry => {
      const li = document.createElement('li');
      li.style.marginBottom = '10px';
      li.innerHTML = `<strong>${entry.date}</strong> - <em>${entry.type}</em>${entry.student ? ` for <strong>${entry.student}</strong>` : ''}<br>${entry.details}`;
      logList.appendChild(li);
    });
  }

  document.getElementById('logEntryForm').addEventListener('submit', () => {
    const entry = {
      type: logType.value,
      student: logStudent.value.trim(),
      date: logDate.value,
      details: logDetails.value.trim(),
    };

    if (!entry.type || !entry.date || !entry.details) {
      alert('Please fill in all required fields.');
      return;
    }

    logEntries.unshift(entry);
    localStorage.setItem('logEntries', JSON.stringify(logEntries));
    renderLogEntries();

    logType.value = '';
    logStudent.value = '';
    logDate.value = '';
    logDetails.value = '';
    alert('Log entry added!');
  });

  populateStudentDropdown();
  renderLogEntries();
  </div>

  <script>
    const tabs = document.querySelectorAll('.nav-tab');
    const contents = document.querySelectorAll('.tab-content');

    tabs.forEach(tab => {
      tab.addEventListener('click', () => {
        tabs.forEach(t => t.classList.remove('active'));
        contents.forEach(c => c.classList.remove('active'));

        tab.classList.add('active');
        document.getElementById(tab.dataset.tab).classList.add('active');
      });
    });

    // Reset calendar on load
    window.addEventListener('load', () => {
      const today = new Date();
      currentMonth = today.getMonth();
      currentYear = today.getFullYear();
      buildCalendar(currentMonth, currentYear);
    });
  </script>
</body>
</html>
